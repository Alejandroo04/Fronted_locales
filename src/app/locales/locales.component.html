<div class="locales-container">
    <header class="locales-header">
    <button (click)="goToDashboard()" class="back-to-dashboard">Volver al Dashboard</button>
    <h1>Locales</h1>
    <button (click)="showForm = !showForm" *ngIf="localStorage.roles.id == 3">A√±adir Local</button>
    </header>
    @if(localStorage.roles.id == 3){
      <div *ngIf="showForm">
        <form [formGroup]="formLocal" (submit)="createLocal()">
          
          <input type="text" placeholder="Nombre del negocio" name="nombre" required formControlName="nombreNegocio">
      
          <input type="text" placeholder="Ubicaci√≥n" name="ubicacion" required formControlName="ubicacion">
          <input type="number" placeholder="telefono" name="telefono" required formControlName="telefono">
          <select id="representanteLegal" formControlName="representanteLegal">
            <option value="" disabled>Selecciona una responsable</option>
            <option *ngFor="let usuario of usuarios" [value]="usuario.id">{{ usuario.name }}</option>
          </select>
          <select id="categoria" formControlName="categoria" (change)="onCategoriaChange()">
            <option value="" disabled>Selecciona una categor√≠a</option>
            <option *ngFor="let categoria of categorias" [value]="categoria.id">{{ categoria.name }}</option>
          </select>
          <div *ngIf="formLocal.get('categoria')?.value">
            <label for="subcategoria">Subcategor√≠a:</label>
            <select id="subcategoria" formControlName="subcategoria">
              <option value="" disabled>Selecciona una subcategor√≠a</option>
              <option *ngFor="let subcategoria of selectedCategoria.subcategories" [value]="subcategoria.id">
                {{ subcategoria.nombre }}
              </option>
            </select>
          </div>

          
          <button type="submit" [disabled]="formLocal.invalid">Crear Local</button>
        </form>
      </div>
    }


    <table class="locales-table">
      <thead>
        <tr>
          <th>Nombre de negocio</th>
          <th>Ubicaci√≥n</th>
          <th>Tel√©fono</th>
          <th>Representante Legal</th>
          <th>Categor√≠a</th>
          <th>Subcategor√≠a</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let local of locales">
          <td>{{ local.nombreNegocio }}</td>
          <td>{{ local.ubicacion }}</td>
          <td>{{ local.telefono }}</td>
          <td>{{ local.representanteLegal }}</td>
          <td>{{ local.categoria }}</td>
          <td>{{ local.subcategoria }}</td>
          @if(localStorage.roles.id == 3){
            <td>
              <button (click)="editLocal(local)">‚úèÔ∏è</button>
              <button (click)="deleteLocal(local)">üóëÔ∏è</button>
            </td>
          }
        </tr>
      </tbody>
    </table>
  </div>
  
